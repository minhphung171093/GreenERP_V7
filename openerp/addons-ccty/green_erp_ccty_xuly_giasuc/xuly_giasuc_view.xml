<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    	<record id="xuly_giasuc_search" model="ir.ui.view">
	        <field name="name">xuly.giasuc.search</field>
	        <field name="model">xuly.giasuc</field>
	        <field name="type">search</field>
	        <field name="arch" type="xml">
	            <search string="Xử lý gia súc">
	                <group>
   						<field name="name" />
	                	<field name="loai_id" />
	                    <field name="ngay" />
	                   	<field name="company_id" />                   
	                    <field name="can_bo_id" />
	                    <field name="quan_huyen_id" />
	                    <field name="phuong_xa_id" />
	                    <field name="khu_pho_id" />
	                    <field name="ten_ho_id" /> 
	                    <field name="can_bo_ghi_so" />
	                </group>
	                <separator/>
                    <group expand="0" string="Group By...">
                        <filter string="Quận (huyện)" domain="[]" context="{'group_by':'quan_huyen_id'}"/>
                        <filter string="Phường (xã)" domain="[]"  context="{'group_by':'phuong_xa_id'}"/>
                        <filter string="Khu phố (ấp)" domain="[]" context="{'group_by':'khu_pho_id'}"/>
                        <filter string="Loài" domain="[]"  context="{'group_by':'loai_id'}"/>
                        <filter string="Hộ" domain="[]"  context="{'group_by':'ten_ho_id'}"/>
                        <filter string="Ngày cấp" domain="[]"  context="{'group_by':'ngay_cap'}"/>
                        <filter string="Cán bộ" domain="[]"  context="{'group_by':'can_bo_id'}"/>
                        <filter string="Trạm" domain="[]"  context="{'group_by':'company_id'}"/>
                    </group>
	            </search>	
	        </field>
	    </record>
    
        <record model="ir.ui.view" id="xuly_giasuc_tree">
            <field name="name">xuly.giasuc.tree</field>
            <field name="model">xuly.giasuc</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Xử lý gia súc">
                	<field name="name" />
                	<field name="loai_id" />
                    <field name="ngay" />
                   	<field name="company_id" />                   
                    <field name="can_bo_id" />
                    <field name="quan_huyen_id" />
                    <field name="phuong_xa_id" />
                    <field name="khu_pho_id" />
                    <field name="ten_ho_id" /> 
                    <field name="trang_thai_id" />
                    <field name="can_bo_ghi_so" />
                    <field name="co_khong_tp" />
                	<field name="hien_an" invisible = '1'/>
                	<field name="chinh_sua_rel" invisible = '1'/>
                </tree>
            </field>
        </record>
        
        <record model="ir.ui.view" id="xuly_giasuc_form">
            <field name="name">xuly.giasuc.form</field>
            <field name="model">xuly.giasuc</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Xử lý gia súc" version="7.0">
                	<header>
	            		<button name="bt_duyet" groups = "green_erp_ccty_xuly_giasuc.group_xuly_giasuc_manager" attrs="{'invisible': [('hien_an', '!=', True)]}" string="Duyệt" type="object" class="oe_highlight" />
	                    <field name="trang_thai_id" widget="statusbar"/>
	            	</header> 
	                <sheet>
	        			<group col="4">
		                    <field name="name" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			            	<field name="loai_id" on_change = "onchange_chon_loai(ten_ho_id, loai_id)" options="{'create': false, 'create_edit': false}" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			                <field name="ngay" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			                <field name="can_bo_ghi_so" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			               	<field name="company_id" readonly = '1' attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>                   
			                <field name="can_bo_id" readonly = '1' domain="[('company_id','=',company_id)]" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			                <field name="quan_huyen_id" options="{'create': false, 'create_edit': false}" on_change="onchange_quan_huyen()" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
			                <field name="phuong_xa_id" options="{'create': false, 'create_edit': false}" on_change="onchange_phuong_xa()" domain="[('quan_huyen_id','=',quan_huyen_id)]" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
		                    <field name="khu_pho_id" options="{'create': false, 'create_edit': false}" on_change="onchange_khu_pho()" domain="[('phuong_xa_id','=',phuong_xa_id), ('quan_huyen_id','=',quan_huyen_id)]" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
		                    <field name="ten_ho_id" on_change = "onchange_chon_loai(ten_ho_id, loai_id)" options="{'create': false, 'create_edit': false}" context="{'search_ten_ho_id':True}" domain="[('quan_huyen_id','=',quan_huyen_id), ('phuong_xa_id','=',phuong_xa_id), ('khu_pho_id','=',khu_pho_id)]" attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}"/>
	            			<field name="hien_an" invisible = '1'/>
	            			<field name="chinh_sua_rel" invisible = '1'/>
	            			<field name="co_khong_tp" string = "Có tiêm phòng"/>
	            		</group>
                		<notebook>
							<page string = "Thông tin chi tiết xử lý gia súc">
								<field name="chitiet_loai_xuly" nolabel='1' attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}">
									<tree editable='bottom' create = 'false' delete = 'false' >
										<field name="name"/>
										<field name="tong_dan" sum = 'Total'/>
										<field name="so_luong" attrs="{'required':[('tong_dan','!=',0)]}" on_change = "onchange_dvt(dvt,so_luong)"/>
										<field name="dvt" attrs="{'required':[('tong_dan','!=',0)]}"  on_change = "onchange_dvt(dvt,so_luong)" />
										<field name="sl_tuong_duong" attrs="{'required':[('tong_dan','!=',0)]}" sum = 'Total' />
										<field name="ly_do" /> 
					                    <field name="ket_qua_xn" /> 
					                    <field name="bien_phap" /> 
									</tree>
								</field>
							</page>
							<page string = "Thông tin chi tiết hoá chất">
								<field name="chi_tiet_vaccine_line" nolabel='1' attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}">
									<tree editable='bottom'>
										<field name="loai_hoa_chat_id" options="{'create': false, 'create_edit': false}"/>
					                    <field name="so_luong"/>
									</tree>
								</field>
							</page>
							<page string = "Đã tiêm phòng" attrs="{'invisible': [('co_khong_tp', '=', 'khong')]}">
								<field name="chi_tiet_tp_line" nolabel='1' attrs="{'readonly': [('chinh_sua_rel', 'not in', ['nhap', False])]}">
									<tree editable='bottom' create = 'false'>
										<field name="tiem_phong_id" readonly="1" options="{'create': false, 'create_edit': false}"/>
										<field name="vacxin_id" options="{'create': false, 'create_edit': false}"/>
										<field name="name" readonly="1" />
										<field name="sl_tiem" sum = 'Total'/>
										<field name="so_luong" sum = 'Total'/>
									</tree>
								</field>
							</page>
						</notebook>
	                </sheet>
                </form>
            </field>
        </record>
       
        <record model="ir.actions.act_window" id="action_xuly_giasuc">
            <field name="name">Thông tin xử lý gia súc</field>
            <field name="res_model">xuly.giasuc</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'readonly_by_pass':1}</field> 
        </record>

        			
    </data>
</openerp>
